image: Visual Studio 2022

platform:
  - x64

environment:
  nodejs_version: "20"

install:
  # Install Node.js
  - ps: Install-Product node $env:nodejs_version
  
  # Install dependencies, skip native rebuild (electron-builder will handle it)
  - npm install --legacy-peer-deps

build_script:
  # Build without native module rebuild (use prebuilt binaries)
  - set npm_config_build_from_source=false
  - npm run build:win

artifacts:
  - path: dist\*.exe
    name: installer

cache:
  - node_modules
  - '%LOCALAPPDATA%\electron\Cache'
  - '%LOCALAPPDATA%\electron-builder\Cache'
