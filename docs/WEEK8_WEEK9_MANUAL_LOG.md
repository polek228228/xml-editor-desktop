# Manual QA Log — Week 8 & Week 9 Features

**Дата:** 2025-11-01  
**Тестер:** Потапов В.С.  
**Сборка:** `npm run dev` (Electron 28.3.3, macOS 14.5 arm64)  
**База данных:** свежая (`~/Library/Application Support/xml-editor-desktop/xmleditor.db`)

---

## Week 8 — PDF Export & Export Dialog

| Шаг | Действие | Ожидание | Фактический результат | Статус |
|-----|----------|----------|-----------------------|--------|
| 1 | Запуск `npm run dev`, проверка логов | Приложение стартует без ошибок | ✅ `Database initialized successfully`, `Default modules seeded successfully.` | PASS |
| 2 | Создать документ → `Создать документ` → ввести `Тестовая пояснительная записка - Жилой комплекс "Светлый"`, выбрать схему 01.05 | Документ открыт, тулбар активен | ✅ Новая вкладка с документом, кнопки сохранения активны | PASS |
| 3 | Заполнить ключевые поля (Раздел 0 — дата/номер, Раздел 1 — название проекта/организация, Раздел 2 — ТЭП, Раздел 5 — кадастровый номер) | Поля принимают значения, ошибок нет | ✅ Данные сохранены, авто‑сохранение каждые 30 сек | PASS |
| 4 | Нажать `Экспорт` → проверить диалог | Диалог показывает выбор XML/PDF, текущую схему, превью XML | ✅ ExportDialog с радио XML/PDF, схема = 01.05 | PASS |
| 5 | Выбрать «PDF», сохранить в `~/Documents/...pdf` | Появляется тост «Генерация PDF...», затем «PDF файл успешно создан» | ✅ Лог `PDF saved to ...`, тост об успехе | PASS |
| 6 | Открыть PDF (Preview) | Документ по шаблону Минстроя (Times New Roman, титульник, оглавление) | ✅ PDF 4 страницы, корректные данные | PASS |
| 7 | Экспортировать XML (из того же диалога) | Пройти XSD валидацию, показать тост «XML файл сохранён» | ✅ Лог `Validation successful - XML is valid`, тост успеха | PASS |
| 8 | Проверить `logs/electron.log` | Есть записи о генерации PDF и успешной валидации XML | ✅ Лог содержит блок `[PDFGenerator] ...` | PASS |

**Вывод Week 8:** экспорт работает в обоих форматах, диалог отображает правильные опции, PDF генерируется по шаблону, XSD валидация проходит.

### Артефакты
- `/Users/PotapovViS/Documents/Тестовая пояснительная записка - Жилой комплекс "Светлый".pdf`
- `/Users/PotapovViS/Documents/Тестовая пояснительная записка - Жилой комплекс "Светлый".xml`
- `logs/electron.log`

---

## Week 9 — Form System (14 Sections) & Schema Switching

| Шаг | Действие | Ожидание | Фактический результат | Статус |
|-----|----------|----------|-----------------------|--------|
| 1 | Новый документ → `Test 14 Sections`, схема 01.05 | Документ открыт | ✅ Вкладка создана, тулбар активен | PASS |
| 2 | Развернуть секции 0–12 | Видны 14 accordion‑секций | ✅ Информация о документе + Разделы 1–12 | PASS |
| 3 | Проверить типы полей (text/number/date/textarea/select/repeater) | Поля соответствуют JSON schema; repeaters работают | ✅ Повторители добавляют/удаляют записи | PASS |
| 4 | `Сохранить` документ | Тост «Документ сохранён», запись в БД | ✅ Тост + лог `document saved` | PASS |
| 5 | Переключить схему на 01.04 | Формы перегенерированы, данные сохранены | ✅ Значения подтянуты, секции по 01.04 | PASS |
| 6 | Переключить схему на 01.03 | Аналогично 01.03 | ✅ Работает без ошибок | PASS |
| 7 | Проверить автосохранение (30 с) | Тост «Автосохранение», запись в `autosaves` | ✅ Сообщение появилось, запись в БД | PASS |
| 8 | Перезапустить приложение, открыть документ из «Последние» | Документ с сохранёнными данными | ✅ Все поля восстановлены | PASS |
| 9 | `npm run test:e2e:smoke` | Все smoke-тесты зелёные | ✅ `9 passed (24.9s)` | PASS |

**Вывод Week 9:** FormManager генерирует 14 секций из схемы, переключение версий работает, автосохранение и загрузка документов стабильны, smoke тесты зелёные.

### Артефакты
- SQLite: записи `Test 14 Sections` в `documents` и `autosaves`
- `logs/electron.log`
- Playwright: `npx playwright show-report test-results/html-report`

---

## Рекомендации
1. Добавить автоматический PDF тест (mock save dialog) — backlog Phase B.
2. Собрать Windows build и повторить сценарии.
3. Оформить QA чек-лист позитивных сценариев перед релизом.
